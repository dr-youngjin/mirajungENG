<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title id="pageTitle">월말평가 A TYPE</title>
  <style>
    /* ======================= 기본 색상 및 변수 ======================= */
    :root {
      --primary-color: #3498db;
      --primary-dark: #2980b9;
      --secondary-color: #2c3e50;
      --light-gray: #f8f9fa;
      --light-gray-2: #ecf0f1;
      --success-color: #2ecc71;
      --success-dark: #27ae60;
      --warning-color: #f39c12;
      --warning-dark: #d35400;
      --danger-color: #e74c3c;
      --danger-dark: #c0392b;
      --purple-color: #9b59b6;
      --purple-dark: #8e44ad;
      --disabled-color: #bdc3c7;
      --button-color: #322D55; /* 다음문제/완료 버튼 컬러 */
      --complete-button-color: #8957a1; /* 완료 버튼 컬러 (보라색) */
      --progress-left-color: #00D2F7; /* 게이지바 왼쪽 컬러 (밝은 하늘색) */
      --progress-right-color: #7DF9AA; /* 게이지바 오른쪽 컬러 (밝은 녹색) */
      --progress-gradient: linear-gradient(90deg, var(--progress-left-color) 0%, var(--progress-right-color) 100%);
      --progress-shine: rgba(255,255,255,0.35);
      --keyboard-top: #f5f5f5;
      --keyboard-side: #ddd;
      --keyboard-bottom: #bbb;
    }
    
    /* ======================= 공통 배경 및 레이아웃 ======================= */
    body {
      margin: 0;
      padding: 10px;
      font-family: 'Noto Sans KR', sans-serif;
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      color: #333;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      overflow-x: hidden;
      position: relative;
    }
    
    /* 전체 배경에 반짝이는 효과 적용 */
    body::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%2393c5fd' fill-opacity='0.1' fill-rule='evenodd'/%3E%3C/svg%3E");
      opacity: 0.3;
      z-index: -1;
    }
    
    /* ======================= 배너 & 제목 ======================= */
    .banner {
      width: 100%;
      text-align: center;
      background-color: white;
      padding: 15px 0;
      margin-bottom: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      display: none; /* 기본 숨김; 배너 URL이 있으면 보임 */
    }
    .banner img {
      max-width: 100%;
      height: auto;
    }
    #gameTitle {
      text-align: center;
      font-size: 32px;
      font-weight: bold;
      margin-bottom: 20px;
      color: var(--secondary-color);
      text-shadow: 2px 2px 2px rgba(0,0,0,0.2), 0 0 15px rgba(255,255,255,0.8);
      position: relative;
      padding: 15px 30px;
      border-radius: 12px;
      background: linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(240,242,245,0.85) 100%);
      backdrop-filter: blur(4px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.08), inset 0 -2px 5px rgba(0,0,0,0.03);
      display: inline-block;
      letter-spacing: 1px;
      transform: perspective(100px) translateZ(5px);
      border: 1px solid rgba(255,255,255,0.7);
    }
    #gameTitle::after {
      content: '';
      position: absolute;
      bottom: -10px;
      left: 50%;
      transform: translateX(-50%);
      width: 80px;
      height: 3px;
      background: linear-gradient(90deg, var(--button-color), var(--purple-color));
      border-radius: 3px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    /* ======================= 컨테이너 & 정보 패널 ======================= */
    .container {
      max-width: 1100px;
      width: 95%;
      margin: 0 auto;
      background-color: rgba(255,255,255,0.9);
      border-radius: 12px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      padding: 30px;
      transition: all 0.3s ease;
      backdrop-filter: blur(5px);
      position: relative;
      overflow: hidden;
    }
    .container:hover { 
      box-shadow: 0 8px 25px rgba(0,0,0,0.15); 
    }
    .container::before {
      content: '';
      position: absolute;
      top: -100%;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
      transform: rotate(45deg);
      animation: shine-container 8s infinite linear;
    }
    @keyframes shine-container {
      0% { top: -100%; left: -100%; }
      100% { top: 100%; left: 100%; }
    }
    .info-panel {
      display: flex;
      justify-content: center;
      background-color: var(--light-gray);
      padding: 15px;
      border-radius: 10px;
      margin-bottom: 25px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }
    .info-item {
      text-align: center;
      padding: 0 15px;
      flex: 1;
    }
    .info-label {
      font-weight: 500;
      margin-bottom: 5px;
      color: #7f8c8d;
      font-size: 0.9rem;
      text-transform: uppercase;
    }
    .info-value {
      font-size: 1.3rem;
      color: var(--secondary-color);
      font-weight: bold;
    }
    
    /* ======================= 시작 화면 ======================= */
    #startSection {
      text-align: center;
      padding: 40px 0;
      background-color: rgba(255,255,255,0.8);
      border-radius: 12px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      max-width: 600px;
      margin: 40px auto;
      position: relative;
      z-index: 1;
      overflow: hidden;
    }
    #startSection::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255,255,255,0.3) 10%, transparent 60%);
      animation: pulse-start 5s infinite linear;
      z-index: -1;
    }
    @keyframes pulse-start {
      0% { transform: scale(0.95); opacity: 0.7; }
      50% { transform: scale(1.05); opacity: 0.3; }
      100% { transform: scale(0.95); opacity: 0.7; }
    }
    .start-title {
      font-size: 28px;
      margin-bottom: 30px;
      position: relative;
      display: inline-block;
      color: var(--secondary-color);
    }
    .start-title::after {
      content: '';
      position: absolute;
      bottom: -10px;
      left: 0;
      width: 100%;
      height: 2px;
      background: linear-gradient(90deg, transparent, var(--button-color), transparent);
    }
    .input-field {
      padding: 15px 20px;
      font-size: 16px;
      border: none;
      border-radius: 10px;
      width: 300px;
      margin-right: 10px;
      outline: none;
      transition: all 0.3s;
      box-shadow: 0 3px 10px rgba(0,0,0,0.1), 
                  inset 0 2px 5px rgba(0,0,0,0.05);
      background-color: white;
      color: var(--secondary-color);
    }
    .input-field:focus {
      box-shadow: 0 5px 15px rgba(52,152,219,0.2), 
                  inset 0 2px 5px rgba(0,0,0,0.05);
      transform: translateY(-2px);
    }
    .input-field::placeholder {
      color: #bdc3c7;
      transition: all 0.3s;
    }
    .input-field:focus::placeholder {
      opacity: 0.7;
      transform: translateX(5px);
    }
    
    /* ======================= 키보드 스타일 버튼 ======================= */
    .btn {
      padding: 14px 24px;
      font-size: 16px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      margin: 10px 5px;
      font-weight: 500;
      position: relative;
      color: white;
      text-shadow: 0 1px 1px rgba(0,0,0,0.2);
      transition: all 0.15s ease;
      background-color: var(--keyboard-top);
      box-shadow: 
        0 0 0 1px rgba(0,0,0,0.1),
        0 2px 0 rgba(0,0,0,0.1),
        0 4px 0 var(--keyboard-bottom),
        0 6px 0 rgba(0,0,0,0.1),
        0 8px 0 rgba(0,0,0,0.1),
        0 0 10px rgba(0,0,0,0.2);
      transform: translateY(-4px);
      overflow: hidden;
    }
    .btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 50%;
      background: linear-gradient(to bottom, rgba(255,255,255,0.2), transparent);
      border-radius: 7px 7px 0 0;
    }
    .btn:after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 40%;
      background: linear-gradient(to top, rgba(0,0,0,0.1), transparent);
      border-radius: 0 0 7px 7px;
    }
    .btn:hover {
      transform: translateY(-5px);
      box-shadow: 
        0 0 0 1px rgba(0,0,0,0.1),
        0 3px 0 rgba(0,0,0,0.1),
        0 5px 0 var(--keyboard-bottom),
        0 7px 0 rgba(0,0,0,0.1),
        0 9px 0 rgba(0,0,0,0.1),
        0 0 12px rgba(0,0,0,0.2);
    }
    .btn:active {
      transform: translateY(0px);
      box-shadow: 
        0 0 0 1px rgba(0,0,0,0.1),
        0 1px 0 rgba(0,0,0,0.1),
        0 2px 0 var(--keyboard-bottom),
        0 0 5px rgba(0,0,0,0.2);
      transition: all 0.05s ease;
    }
    .btn:disabled {
      background-color: var(--disabled-color);
      cursor: not-allowed;
      transform: translateY(-2px);
      box-shadow: 
        0 0 0 1px rgba(0,0,0,0.1),
        0 1px 0 rgba(0,0,0,0.1),
        0 2px 0 #aaa,
        0 3px 0 rgba(0,0,0,0.1),
        0 0 5px rgba(0,0,0,0.2);
    }
    #startButton { background-color: var(--success-color); }
    #nextButton { background-color: var(--button-color); }
    #nextButton.complete-button { 
      background-color: var(--complete-button-color); 
      box-shadow: 
        0 0 0 1px rgba(0,0,0,0.1),
        0 2px 0 rgba(0,0,0,0.1),
        0 4px 0 #7a4391,
        0 6px 0 rgba(0,0,0,0.1),
        0 8px 0 rgba(0,0,0,0.1),
        0 0 10px rgba(0,0,0,0.2);
    }
    #nextButton.complete-button:hover {
      transform: translateY(-5px);
      box-shadow: 
        0 0 0 1px rgba(0,0,0,0.1),
        0 3px 0 rgba(0,0,0,0.1),
        0 5px 0 #7a4391,
        0 7px 0 rgba(0,0,0,0.1),
        0 9px 0 rgba(0,0,0,0.1),
        0 0 12px rgba(137, 87, 161, 0.4);
    }
    #submitButton { background-color: var(--warning-color); }
    
    /* ======================= 문제 영역 ======================= */
    #gameSection { display: none; width: 100%; }
    .question-container {
      display: flex;
      flex-direction: row;
      margin-bottom: 30px;
      background-color: var(--light-gray);
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      padding: 20px;
      min-height: 500px;
      overflow: hidden;
      position: relative;
    }
    .question-container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 5px;
      background: linear-gradient(90deg, var(--button-color), var(--purple-color));
      border-radius: 10px 10px 0 0;
    }
    /* 보기(지문) 영역 - 좌측 고정 영역 */
    .passage {
      flex: 0 0 38%;
      padding-right: 10px;
      max-height: 600px;
      overflow-y: auto;
      border-right: 1px solid #eee;
      display: none; /* 기본적으로 없으면 숨김, 문제가 있으면 보임 */
    }
    .passage img { width: 100%; height: auto; display: block; }
    
    /* 문제 영역 - 보기가 없는 경우 중앙 정렬, 보기가 있으면 우측 영역 */
    .question {
      flex: 1;
      text-align: center;
      padding: 15px;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .question.with-passage { margin-left: 10px; }
    .question-number {
      font-size: 1.2rem;
      font-weight: bold;
      margin-bottom: 15px;
      color: var(--secondary-color);
      background-color: var(--light-gray-2);
      padding: 8px 15px;
      border-radius: 20px;
      display: inline-block;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .question-images {
      width: 100%;
      text-align: center;
      margin-bottom: 20px;
      max-width: 800px;
    }
    .image-container {
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      font-size: 0; /* 이미지 간 여백 제거 */
      line-height: 0;
    }
    .question-image {
      width: 100%;
      height: auto;
      display: block;
      margin: 0;
      padding: 0;
      vertical-align: bottom;
      border-radius: 5px;
      box-shadow: 0 3px 6px rgba(0,0,0,0.1);
      transition: all 0.3s ease;
    }
    .question-image + .question-image {
      border-top-left-radius: 0;
      border-top-right-radius: 0;
      margin-top: -1px; /* 이미지 간 경계선 제거 */
      box-shadow: none;
    }
    .question-image:first-child {
      border-bottom-left-radius: 0;
      border-bottom-right-radius: 0;
    }
    .question-image:hover {
      transform: scale(1.01);
      box-shadow: 0 5px 15px rgba(0,0,0,0.15);
      z-index: 2; /* 호버 시 다른 이미지 위에 표시 */
    }
    .options {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin: 30px 0;
      width: 100%;
    }
    .option {
      width: 60px;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: radial-gradient(ellipse at 30% 30%, var(--primary-color) 0%, var(--primary-dark) 100%);
      color: white;
      font-size: 20px;
      font-weight: bold;
      border-radius: 50%;
      cursor: pointer;
      transition: all 0.3s;
      box-shadow: 
        0 6px 12px rgba(0,0,0,0.15), 
        0 3px 5px rgba(0,0,0,0.12), 
        inset 0 -4px 5px rgba(0,0,0,0.2),
        inset 0 2px 4px rgba(255,255,255,0.5);
      position: relative;
      overflow: hidden;
      transform-style: preserve-3d;
      transform: perspective(500px) rotateX(10deg);
    }
    .option::before {
      content: '';
      position: absolute;
      width: 100%;
      height: 100%;
      border-radius: 50%;
      background: radial-gradient(ellipse at 30% 30%, rgba(255,255,255,0.3) 0%, rgba(255,255,255,0) 70%);
      top: 0;
      left: 0;
      z-index: 2;
    }
    .option::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 60%;
      background: linear-gradient(to bottom, rgba(255,255,255,0.4), rgba(255,255,255,0));
      border-radius: 50% 50% 100% 100%;
      transform: translateZ(1px);
    }
    .option:hover {
      background: radial-gradient(ellipse at 30% 30%, var(--primary-color) 30%, var(--primary-dark) 100%);
      transform: perspective(500px) rotateX(15deg) translateY(-3px) scale(1.05);
      box-shadow: 
        0 10px 20px rgba(0,0,0,0.2), 
        0 5px 8px rgba(0,0,0,0.15), 
        inset 0 -4px 5px rgba(0,0,0,0.2),
        inset 0 2px 4px rgba(255,255,255,0.5);
    }
    .option.selected {
      background: radial-gradient(ellipse at 30% 30%, var(--warning-color) 0%, var(--warning-dark) 100%);
      transform: perspective(500px) rotateX(15deg) scale(1.1);
      box-shadow: 
        0 8px 25px rgba(0,0,0,0.15), 
        0 5px 10px rgba(0,0,0,0.1), 
        0 0 15px rgba(255, 165, 0, 0.5), 
        inset 0 -4px 5px rgba(0,0,0,0.2),
        inset 0 2px 4px rgba(255,255,255,0.5);
    }
    .input-answer {
      display: flex;
      justify-content: center;
      align-items: center;
      margin: 30px 0;
      width: 100%;
    }
    .answer-input {
      padding: 15px 20px;
      font-size: 16px;
      border: none;
      border-radius: 10px;
      width: 280px;
      outline: none;
      transition: all 0.3s;
      box-shadow: 0 3px 10px rgba(0,0,0,0.1), 
                  inset 0 2px 5px rgba(0,0,0,0.05);
      background-color: white;
      color: var(--secondary-color);
    }
    .answer-input:focus {
      box-shadow: 0 5px 15px rgba(52,152,219,0.2), 
                  inset 0 2px 5px rgba(0,0,0,0.05);
      transform: translateY(-2px);
    }
    
    /* ======================= 진행률 게이지 ======================= */
    .progress-container {
      width: 100%;
      height: 15px;
      background-color: rgba(236,240,241,0.8);
      border-radius: 8px;
      margin-top: 30px;
      margin-bottom: 15px;
      overflow: hidden;
      position: relative;
      box-shadow: inset 0 1px 3px rgba(0,0,0,0.2);
    }
    .progress-bar {
      height: 100%;
      background-image: var(--progress-gradient);
      width: 0%;
      transition: width 0.7s cubic-bezier(0.22,0.61,0.36,1.2);
      border-radius: 8px;
      position: relative;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      overflow: hidden;
    }
    /* 반짝이는 효과 */
    .progress-bar::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, var(--progress-shine), transparent);
      animation: shine 2s infinite;
      z-index: 2;
    }
    /* 물결 효과 - 첫 번째 물결 */
    .progress-bar::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -100%;
      width: 200%;
      height: 200%;
      background-image: 
        repeating-linear-gradient(
          45deg, 
          rgba(255,255,255,0.1) 0%, 
          rgba(255,255,255,0.1) 5%, 
          rgba(255,255,255,0.3) 10%, 
          rgba(255,255,255,0.1) 15%, 
          rgba(255,255,255,0.1) 20%
        );
      animation: wave 8s infinite linear;
      z-index: 1;
    }
    /* 두 번째 물결 (반대 방향) */
    .progress-container::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: 
        repeating-linear-gradient(
          -45deg, 
          rgba(255,255,255,0.05) 0%, 
          rgba(255,255,255,0.05) 7%, 
          rgba(255,255,255,0.2) 14%, 
          rgba(255,255,255,0.05) 21%, 
          rgba(255,255,255,0.05) 28%
        );
      animation: wave-reverse 10s infinite linear;
      border-radius: 8px;
      z-index: 0;
      opacity: 0.6;
      pointer-events: none;
    }
    @keyframes shine {
      0% { left: -100%; }
      20% { left: 100%; }
      100% { left: 100%; }
    }
    @keyframes wave {
      0% { transform: rotate(0) translateX(-25%); }
      100% { transform: rotate(360deg) translateX(-25%); }
    }
    @keyframes wave-reverse {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(-360deg); }
    }
    .progress-indicator {
      position: absolute;
      right: 10px;
      top: -25px;
      background-color: var(--secondary-color);
      color: white;
      font-size: 0.8rem;
      padding: 3px 10px;
      border-radius: 12px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
      opacity: 0.9;
      transform: translateY(0);
      transition: transform 0.3s ease;
    }
    
    /* 완료 애니메이션 */
    @keyframes explode {
      0% { transform: scale(1); filter: brightness(1); }
      20% { transform: scale(1.05); filter: brightness(1.3); }
      40% { transform: scale(1); filter: brightness(1); }
      60% { transform: scale(1.08); filter: brightness(1.4); }
      80% { transform: scale(1); filter: brightness(1.2); }
      100% { transform: scale(1.03); filter: brightness(1.5); }
    }
    
    .completed-animation {
      animation: explode 1.5s ease-out forwards;
    }
    
    /* 파티클 애니메이션 */
    .particle {
      position: absolute;
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background-color: var(--progress-bar-color);
      opacity: 0;
      animation: particle-animation 1s cubic-bezier(0,0.5,0.5,1) forwards;
    }
    @keyframes particle-animation {
      0% { 
        opacity: 1; 
        transform: translate(0, 0); 
      }
      100% { 
        opacity: 0; 
        transform: translate(
          var(--translateX), 
          var(--translateY)
        ); 
      }
    }
    
    /* ======================= 결과 화면 ======================= */
    #resultSection {
      display: none;
      text-align: center;
      padding: 40px;
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      border-radius: 12px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      max-width: 700px;
      margin: 40px auto;
      position: relative;
      overflow: hidden;
      animation: fadeIn 0.5s ease-in-out;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    #resultSection::before {
      content: '';
      position: absolute;
      top: -50px;
      left: -50px;
      right: -50px;
      bottom: -50px;
      background: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%2393c5fd' fill-opacity='0.1' fill-rule='evenodd'/%3E%3C/svg%3E");
      opacity: 0.3;
      z-index: -1;
    }
    .result-title {
      font-size: 32px;
      font-weight: bold;
      margin-bottom: 25px;
      color: var(--secondary-color);
      text-transform: uppercase;
      letter-spacing: 1px;
      position: relative;
      display: inline-block;
      padding-bottom: 10px;
    }
    .result-title::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 80px;
      height: 3px;
      background: linear-gradient(90deg, var(--button-color), var(--purple-color));
      border-radius: 3px;
    }
    .result-info {
      font-size: 20px;
      margin-bottom: 20px;
      padding: 15px;
      background-color: rgba(255,255,255,0.7);
      border-radius: 8px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      backdrop-filter: blur(4px);
      transition: all 0.3s ease;
    }
    #finalTime {
      font-weight: 600; /* 경과 시간 텍스트를 더 진하게 */
      color: #2c3e50; /* 더 진한 색상 적용 */
    }
    #finalScore {
      font-size: 30px;
      font-weight: bold;
      margin: 25px auto;
      padding: 20px;
      background: linear-gradient(120deg, var(--button-color) 0%, var(--purple-color) 46%, #FFCC70 100%);
      color: white;
      border-radius: 12px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.2);
      max-width: 400px;
      text-shadow: 1px 1px 3px rgba(0,0,0,0.3);
      animation: pulsate 2s infinite alternate;
      transition: transform 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    #finalScore::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 200%;
      height: 100%;
      background: linear-gradient(to right, transparent, rgba(255,255,255,0.3), transparent);
      transform: skewX(-25deg);
      animation: shine-score 3s infinite;
    }
    @keyframes shine-score {
      0% { left: -100%; }
      45%, 100% { left: 100%; }
    }
    @keyframes pulsate {
      0% { transform: scale(1); box-shadow: 0 8px 20px rgba(0,0,0,0.2); }
      100% { transform: scale(1.05); box-shadow: 0 12px 25px rgba(76,175,80,0.3); }
    }
    #finalScore:hover { transform: translateY(-5px); }
    .answers-summary {
      margin: 30px 0;
      padding: 25px;
      background-color: rgba(255,255,255,0.8);
      border-radius: 12px;
      text-align: left;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
      gap: 15px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      max-width: 600px;
      margin: 0 auto;
    }
    .answer-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      padding: 10px;
      border-radius: 8px;
      background-color: white;
      box-shadow: 0 2px 8px rgba(0,0,0,0.06);
      transition: all 0.2s ease;
    }
    .answer-item:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 12px rgba(0,0,0,0.1);
    }
    .answer-item .question-number {
      color: #333;
      font-weight: bold;
      margin-bottom: 5px;
      font-size: 14px;
    }
    .answer-item .correct-answer { font-weight: bold; color: #2196f3; }
    .answer-item .incorrect-answer { font-weight: bold; color: #f44336; }
    .answer-item.correct { border-left: 3px solid #2196f3; }
    .answer-item.incorrect { border-left: 3px solid #f44336; }
    #response {
      margin-top: 20px;
      padding: 15px;
      background-color: var(--light-gray);
      border-radius: 8px;
      text-align: left;
      font-family: monospace;
      white-space: pre-wrap;
      max-height: 200px;
      overflow-y: auto;
    }
    
    /* ======================= 로딩 스피너 ======================= */
    .loading-spinner {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 9999;
      justify-content: center;
      align-items: center;
    }
    .spinner {
      width: 50px;
      height: 50px;
      border: 5px solid #f3f3f3;
      border-top: 5px solid var(--button-color);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* ======================= 반응형 디자인 ======================= */
    @media (max-width: 991px) and (min-width: 481px) {
      .container { padding: 20px; width: 98%; }
      .banner img { max-width: 95%; }
      .info-panel { padding: 12px 8px; }
      .info-item { padding: 0 8px; }
      .info-label { font-size: 0.85rem; }
      .info-value { font-size: 1.2rem; }
      .option { width: 50px; height: 50px; font-size: 1.1rem; }
      .options { gap: 12px; }
    }
    @media (max-width: 480px) {
      .container { padding: 10px; width: 100%; border-radius: 8px; }
      #gameTitle { font-size: 24px; }
      .info-panel { padding: 8px 3px; margin-bottom: 15px; }
      .info-item { padding: 0 3px; }
      .info-label { font-size: 0.7rem; margin-bottom: 3px; }
      .info-value { font-size: 1rem; }
      .btn { padding: 10px 15px; font-size: 0.9rem; margin: 8px 3px; }
      .option { width: 40px; height: 40px; font-size: 0.9rem; }
      .options { gap: 5px; margin: 15px 0; }
      .question-container { padding: 10px; margin-bottom: 15px; min-height: 400px; }
      .question-number { font-size: 1rem; padding: 6px 12px; margin-bottom: 10px; }
      .input-field, .answer-input { width: 100%; margin-right: 0; margin-bottom: 10px; }
      #startSection { padding: 20px 10px; }
    }
  </style>
</head>
<body>
  <!-- 배너 영역 -->
  <div id="banner" class="banner"></div>
  <!-- 게임 제목 -->
  <h1 id="gameTitle"></h1>
  
  <div id="loadingSpinner" class="loading-spinner">
    <div class="spinner"></div>
  </div>
  
  <div class="container">
    <!-- 시작 화면 -->
    <div id="startSection">
      <h2 class="start-title">이름을 입력하고 게임을 시작하세요</h2>
      <div>
        <input type="text" id="playerName" class="input-field" placeholder="이름을 입력하세요">
        <button id="startButton" class="btn">게임시작</button>
      </div>
    </div>
    
    <!-- 게임 진행 화면 -->
    <div id="gameSection">
      <div class="info-panel">
        <div class="info-item">
          <div class="info-label">경과시간</div>
          <div class="info-value" id="timer">00:00</div>
        </div>
      </div>
      
      <div id="questionContainer" class="question-container">
        <!-- 보기(지문) 영역: 보기가 있을 경우 좌측에 표시 -->
        <div id="passage" class="passage"></div>
        <!-- 문제 영역: 보기가 있을 경우 우측, 없으면 전체 중앙 정렬 -->
        <div id="question" class="question">
          <div id="questionNumber" class="question-number">문제 1</div>
          <div id="questionImages" class="question-images"></div>
          
          <!-- 객관식 영역 -->
          <div id="multipleChoice" class="options">
            <div class="option" data-option="1">1</div>
            <div class="option" data-option="2">2</div>
            <div class="option" data-option="3">3</div>
            <div class="option" data-option="4">4</div>
            <div class="option" data-option="5">5</div>
          </div>
          
          <!-- 주관식 영역 -->
          <div id="shortAnswer" class="input-answer" style="display: none;">
            <input type="text" id="answerInput" class="answer-input" placeholder="답을 입력하세요">
          </div>
          
          <!-- 진행률 게이지 -->
          <div class="progress-container">
            <div id="progressBar" class="progress-bar"></div>
            <div id="progressIndicator" class="progress-indicator">0/11</div>
          </div>
          
          <button id="nextButton" class="btn" disabled>다음문제</button>
        </div>
      </div>
    </div>
    
    <!-- 결과 화면 -->
    <div id="resultSection">
      <div class="result-title">게임 종료</div>
      <div class="result-info" id="finalScore"></div>
      <div class="result-info" id="finalTime"></div>
      <div class="answers-summary" id="answersSummary"></div>
      <button id="submitButton" class="btn">전송하기</button>
      <div id="response"></div>
    </div>
  </div>
  
  <script>
    // ==================== 변수 설정 ====================
    // 배너 URL: 값이 있으면 최상단에 배너 표시, 없으면 숨김 처리
    const bannerURL = "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/ENGbanner.png?raw=true";
    // 게임 제목
    const gameTitle = "월말평가 A TYPE";
    // 버튼 컬러 (직접 지정)
    const buttonColor = "#322D55";
    // 게이지바 컬러 (직접 지정)
    const progressBarColor = "#F4A324";
    
    // ==================== DOM 요소 참조 ====================
    const elements = {
      banner: document.getElementById("banner"),
      gameTitle: document.getElementById("gameTitle"),
      startSection: document.getElementById('startSection'),
      gameSection: document.getElementById('gameSection'),
      resultSection: document.getElementById('resultSection'),
      playerName: document.getElementById('playerName'),
      startButton: document.getElementById('startButton'),
      timer: document.getElementById('timer'),
      questionContainer: document.getElementById('questionContainer'),
      passage: document.getElementById('passage'),
      question: document.getElementById('question'),
      questionNumber: document.getElementById('questionNumber'),
      questionImages: document.getElementById('questionImages'),
      multipleChoice: document.getElementById('multipleChoice'),
      shortAnswer: document.getElementById('shortAnswer'),
      answerInput: document.getElementById('answerInput'),
      nextButton: document.getElementById('nextButton'),
      submitButton: document.getElementById('submitButton'),
      finalScore: document.getElementById('finalScore'),
      finalTime: document.getElementById('finalTime'),
      response: document.getElementById('response'),
      progressBar: document.getElementById('progressBar'),
      progressIndicator: document.getElementById('progressIndicator'),
      loadingSpinner: document.getElementById('loadingSpinner')
    };
    
    // ==================== 전역 변수 ====================
    let currentQuestion = 1, score = 0, elapsedTime = 0;
    let timerInterval = null, startTime = 0, gameOver = false, userAnswers = [];
    let answerSubmitted = false;
    let player = "";
    let questions = [];
    let completedQuestions = 0; // 완료된 문제 수를 추적
    
    // ==================== 문제 데이터 초기화 ====================
    function initQuestions() {
      questions = [
        { 
          id: 1, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/B1-17.png?raw=true",
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/1.png?raw=true"
          ], 
          answer: "5", 
          type: "객관식", 
          score: 1 
        },
        { 
          id: 2, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/B1-17.png?raw=true",
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/2.png?raw=true"
          ], 
          answer: "3", 
          type: "객관식", 
          score: 1
        },
        { 
          id: 3, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/B1-17.png?raw=true",
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/3.png?raw=true"
          ], 
          answer: "5", 
          type: "객관식", 
          score: 1
        },
        { 
          id: 4, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/B1-17.png?raw=true",
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/4.png?raw=true"
          ], 
          answer: "4", 
          type: "객관식", 
          score: 1
        },
        { 
          id: 5, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/B1-17.png?raw=true",
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/5.png?raw=true"
          ], 
          answer: "2", 
          type: "객관식", 
          score: 1
        },
        { 
          id: 6, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/B1-17.png?raw=true",
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/6.png?raw=true"
          ], 
          answer: "1", 
          type: "객관식", 
          score: 1
        },
        { 
          id: 7, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/B1-17.png?raw=true",
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/7.png?raw=true"
          ], 
          answer: "5", 
          type: "객관식", 
          score: 1
        },
        { 
          id: 8, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/B1-17.png?raw=true",
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/8.png?raw=true"
          ], 
          answer: "3", 
          type: "객관식", 
          score: 1
        },
        { 
          id: 9, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/B1-17.png?raw=true",
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/9.png?raw=true"
          ], 
          answer: "1", 
          type: "객관식", 
          score: 1
        },
        { 
          id: 10, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/B1-17.png?raw=true",
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/10.png?raw=true"
          ], 
          answer: "2", 
          type: "객관식", 
          score: 1
        },
        { 
          id: 11, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/B1-17.png?raw=true",
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/11.png?raw=true"
          ], 
          answer: "2", 
          type: "객관식", 
          score: 1
        },
        { 
          id: 12, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/B1-17.png?raw=true",
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/12.png?raw=true"
          ], 
          answer: "5", 
          type: "객관식", 
          score: 1
        },
        { 
          id: 13, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/B1-17.png?raw=true",
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/13.png?raw=true"
          ], 
          answer: "4", 
          type: "객관식", 
          score: 1
        },
        { 
          id: 14, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/B1-17.png?raw=true",
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/14.png?raw=true"
          ], 
          answer: "3", 
          type: "객관식", 
          score: 1
        },
        { 
          id: 15, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/B1-17.png?raw=true",
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/15.png?raw=true"
          ], 
          answer: "1", 
          type: "객관식", 
          score: 1
        },
        { 
          id: 16, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/B1-17.png?raw=true",
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/16.png?raw=true"
          ], 
          answer: "1", 
          type: "객관식", 
          score: 3
        },
        { 
          id: 17, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/B1-17.png?raw=true",
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/17.png?raw=true"
          ], 
          answer: "4", 
          type: "객관식", 
          score: 1
        },
        { 
          id: 18, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/B18.png?raw=true",
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/18.png?raw=true"
          ], 
          answer: "5", 
          type: "객관식", 
          score: 1
        },
        { 
          id: 19, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/19.png?raw=true"
          ], 
          answer: "2", 
          type: "객관식", 
          score: 1
        },
        { 
          id: 20, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/20.png?raw=true"
          ], 
          answer: "4", 
          type: "객관식", 
          score: 1
        },
        { 
          id: 21, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/21.png?raw=true",
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/21-1.png?raw=true"
          ], 
          answer: "5", 
          type: "객관식", 
          score: 3
        },
        { 
          id: 22, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/22.png?raw=true"
          ], 
          answer: "2", 
          type: "객관식", 
          score: 1
        },
        { 
          id: 23, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/23.png?raw=true"
          ], 
          answer: "3", 
          type: "객관식", 
          score: 1
        },
        { 
          id: 24, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/24.png?raw=true",
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/24-1.png?raw=true"
          ], 
          answer: "4", 
          type: "객관식", 
          score: 3
        },
        { 
          id: 25, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/25.png?raw=true"
          ], 
          answer: "5", 
          type: "객관식", 
          score: 1
        },
        { 
          id: 26, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/26.png?raw=true"
          ], 
          answer: "4", 
          type: "객관식", 
          score: 1
        },
        { 
          id: 27, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/27.png?raw=true",
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/27-1.png?raw=true"
          ], 
          answer: "4", 
          type: "객관식", 
          score: 1
        },
        { 
          id: 28, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/28.png?raw=true",
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/28-1.png?raw=true"
          ], 
          answer: "3", 
          type: "객관식", 
          score: 1
        },
        { 
          id: 29, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/29.png?raw=true"
          ], 
          answer: "4", 
          type: "객관식", 
          score: 1
        },
        { 
          id: 30, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/30.png?raw=true",
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/30-1.png?raw=true"
          ], 
          answer: "5", 
          type: "객관식", 
          score: 1
        },
        { 
          id: 31, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/B31-34.png?raw=true",
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/31-1.png?raw=true"
          ], 
          answer: "awareness", 
          type: "주관식", 
          score: 1
        },
        { 
          id: 32, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/B31-34.png?raw=true",
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/32.png?raw=true",
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/32-1.png?raw=true"
          ], 
          answer: "1", 
          type: "객관식", 
          score: 1
        },
        { 
          id: 33, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/B31-34.png?raw=true",
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/33.png?raw=true"
          ], 
          answer: "2", 
          type: "객관식", 
          score: 3
        },
        { 
          id: 34, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/B31-34.png?raw=true",
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/34.png?raw=true"
          ], 
          answer: "5", 
          type: "객관식", 
          score: 3
        },
        { 
          id: 35, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/35.png?raw=true",
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/35-1.png?raw=true"
          ], 
          answer: "4", 
          type: "객관식", 
          score: 3
        },
        { 
          id: 36, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/B36-37.png?raw=true",
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/36.png?raw=true"
          ], 
          answer: "4", 
          type: "객관식", 
          score: 3
        },
        { 
          id: 37, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/B36-37.png?raw=true",
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/37.png?raw=true",
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/37-1.png?raw=true"
          ], 
          answer: "2", 
          type: "객관식", 
          score: 1
        },
        { 
          id: 38, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/B38-39.png?raw=true",
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/38.png?raw=true"
          ], 
          answer: "5", 
          type: "객관식", 
          score: 1
        },
        { 
          id: 39, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/B38-39.png?raw=true",
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/39.png?raw=true"
          ], 
          answer: "5", 
          type: "객관식", 
          score: 3
        },
        { 
          id: 40, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/40.png?raw=true",
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/40-1.png?raw=true"
          ], 
          answer: "1", 
          type: "객관식", 
          score: 1
        },
        { 
          id: 41, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/41.png?raw=true"
          ], 
          answer: "4", 
          type: "객관식", 
          score: 1,
          passage: "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/Z41-42.png?raw=true"
        },
        { 
          id: 42, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/42.png?raw=true"
          ], 
          answer: "5", 
          type: "객관식", 
          score: 3,
          passage: "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/Z41-42.png?raw=true"
        },
        { 
          id: 43, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/43.png?raw=true"
          ], 
          answer: "4", 
          type: "객관식", 
          score: 1,
          passage: "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/Z43-45.png?raw=true"
        },
        { 
          id: 44, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/44.png?raw=true"
          ], 
          answer: "5", 
          type: "객관식", 
          score: 1,
          passage: "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/Z43-45.png?raw=true"
        },
        { 
          id: 45, 
          images: [
            "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/45.png?raw=true"
          ], 
          answer: "5", 
          type: "객관식", 
          score: 1,
          passage: "https://github.com/dr-youngjin/image-file/blob/main/%EC%98%81%EC%96%B4%ED%80%B4%EC%A6%88/Z43-45.png?raw=true"
        }
      ];
    }
    
    // ==================== 타이머 함수 ====================
    const timerFunctions = {
      start() {
        startTime = Date.now();
        timerInterval = setInterval(this.update, 1000);
      },
      update() {
        elapsedTime = Math.floor((Date.now() - startTime) / 1000);
        const m = Math.floor(elapsedTime / 60);
        const s = elapsedTime % 60;
        elements.timer.textContent = `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
      },
      stop() { clearInterval(timerInterval); },
      formatTime(sec) {
        const m = Math.floor(sec / 60);
        const s = sec % 60;
        return `${m}분 ${s}초`;
      }
    };
    
    // ==================== 초기화 함수 ====================
    function resetGame() {
      currentQuestion = questions[0].id;
      score = 0;
      elapsedTime = 0;
      gameOver = false;
      userAnswers = [];
      answerSubmitted = false;
      completedQuestions = 0; // 완료된 문제 수 초기화
      elements.timer.textContent = "00:00";
      updateProgressBar();
    }
    
    // 개선된 진행률 게이지 업데이트 함수
    function updateProgressBar() {
      // 완료된 문제 수에 따른 진행률 계산
      const progress = (completedQuestions / questions.length) * 100;
      
      elements.progressBar.style.width = `${progress}%`;
      elements.progressIndicator.textContent = `${completedQuestions}/${questions.length}`;
      
      // 진행 애니메이션 효과
      elements.progressBar.style.transition = "width 0.7s cubic-bezier(0.22,0.61,0.36,1.2)";
    }
    
    // 진행률 100% 완료 시 애니메이션
    function triggerCompletionAnimation() {
      return new Promise(resolve => {
        elements.progressBar.style.width = "100%";
        setTimeout(() => {
          elements.progressBar.classList.add('completed-animation');
          // 파티클 효과 추가
          createCompletionParticles();
          
          // 애니메이션 후 결과 화면으로 이동
          setTimeout(() => {
            resolve();
          }, 1800); // 애니메이션 시간 + 약간의 여유
        }, 300);
      });
    }
    
    // 완료 시 파티클 효과 생성
    function createCompletionParticles() {
      const container = document.querySelector('.progress-container');
      const rect = container.getBoundingClientRect();
      const centerX = rect.left + rect.width / 2;
      const centerY = rect.top + rect.height / 2;
      
      // 파티클 50개 생성 (더 많은 파티클로 강조)
      for (let i = 0; i < 50; i++) {
        const particle = document.createElement('div');
        particle.className = 'particle';
        
        // 랜덤 색상 설정
        const colors = [progressBarColor, buttonColor, '#FFCC70', '#4CAF50', '#9b59b6'];
        particle.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
        
        // 랜덤 크기 설정 (더 큰 파티클)
        const size = Math.random() * 10 + 5;
        particle.style.width = `${size}px`;
        particle.style.height = `${size}px`;
        
        // 랜덤 방향 설정 (더 넓은 범위)
        const angle = Math.random() * Math.PI * 2;
        const distance = Math.random() * 180 + 50;
        const translateX = Math.cos(angle) * distance;
        const translateY = Math.sin(angle) * distance;
        
        particle.style.setProperty('--translateX', `${translateX}px`);
        particle.style.setProperty('--translateY', `${translateY}px`);
        
        // 초기 위치 설정
        particle.style.left = `${centerX - rect.left}px`;
        particle.style.top = `${centerY - rect.top}px`;
        
        // 지연 시간 설정
        particle.style.animationDelay = `${Math.random() * 0.3}s`;
        
        container.appendChild(particle);
        
        // 애니메이션 종료 후 파티클 제거
        setTimeout(() => {
          particle.remove();
        }, 1500);
      }
    }
    
    // ==================== 문제 로드 함수 ====================
    function loadQuestion(qId) {
      answerSubmitted = false;
      elements.nextButton.disabled = true;
      
      // 객관식 옵션 초기화
      document.querySelectorAll('.option').forEach(opt => {
        opt.classList.remove("selected");
      });
      
      const q = questions.find(item => item.id === qId);
      if (!q) { endGame(true); return; }
      
      elements.questionNumber.textContent = `문제 ${q.id}`;
      
      // 보기(지문) 처리
      if (q.passage) {
        elements.passage.style.display = 'block';
        elements.passage.innerHTML = `<img src="${q.passage}" alt="보기" style="width:100%;">`;
        elements.question.classList.add('with-passage');
      } else {
        elements.passage.style.display = 'none';
        elements.question.classList.remove('with-passage');
      }
      
      // 문제 이미지 로드 - 간격 없이 자연스럽게 이어지도록 수정
      elements.questionImages.innerHTML = "";
      const container = document.createElement('div');
      container.className = "image-container";
      
      q.images.forEach((imgUrl, idx) => {
        const img = document.createElement('img');
        img.src = imgUrl;
        img.alt = `문제 ${q.id} 이미지 ${idx + 1}`;
        img.className = "question-image";
        // 이미지 로드 완료 후 자연스럽게 연결
        img.onload = function() {
          // 불필요한 공백 제거 위해 이미지 로드 후 처리
          if (idx > 0) {
            const prevImg = container.querySelector(`img[alt="문제 ${q.id} 이미지 ${idx}"]`);
            if (prevImg) {
              prevImg.style.marginBottom = "0";
            }
          }
        };
        container.appendChild(img);
      });
      
      elements.questionImages.appendChild(container);
      
      // 문제 유형별 분기 처리
      if (q.type === "객관식") {
        elements.multipleChoice.style.display = "flex";
        elements.shortAnswer.style.display = "none";
      } else { // 주관식 문제
        elements.multipleChoice.style.display = "none";
        elements.shortAnswer.style.display = "flex";
        elements.answerInput.value = "";
      }
      
      // 마지막 문제인 경우 "완료" 버튼 텍스트로 변경 및 스타일 적용
      if (qId === questions[questions.length - 1].id) {
        elements.nextButton.textContent = "완료";
        elements.nextButton.classList.add('complete-button');
      } else {
        elements.nextButton.textContent = "다음문제";
        elements.nextButton.classList.remove('complete-button');
      }
    }
    
    // ==================== 객관식 옵션 선택 처리 ====================
    function handleOptionClick(e) {
      if (gameOver) return;
      
      const selectedOption = e.target.closest('.option');
      if (!selectedOption) return;
      
      // 현재 선택된 옵션 초기화 후 새 옵션 선택
      document.querySelectorAll('.option').forEach(opt => {
        opt.classList.remove("selected");
      });
      selectedOption.classList.add("selected");
      
      // 다음버튼 활성화
      elements.nextButton.disabled = false;
    }
    
    // ==================== 주관식 입력 처리 ====================
    function handleShortAnswerInput() {
      if (gameOver) return;
      
      // 입력값이 있으면 다음 버튼 활성화
      if (elements.answerInput.value.trim() !== "") {
        elements.nextButton.disabled = false;
      } else {
        elements.nextButton.disabled = true;
      }
    }
    
    // ==================== 다음 버튼 처리 ====================
    function handleNextButton() {
      if (gameOver) return;
      
      const q = questions.find(item => item.id === currentQuestion);
      if (!q) return;
      
      let userAnswer = "";
      
      // 객관식/주관식 구분하여 답 가져오기
      if (q.type === "객관식") {
        const selected = document.querySelector('.option.selected');
        if (!selected) return;
        userAnswer = selected.getAttribute('data-option');
      } else {
        userAnswer = elements.answerInput.value.trim().toLowerCase();
      }
      
      // 정답 확인 및 점수 계산
      const isCorrect = (userAnswer === q.answer.toString().toLowerCase());
      
      // 사용자 답변 기록
      userAnswers.push({
        questionId: q.id,
        userAnswer: userAnswer,
        correctAnswer: q.answer,
        isCorrect: isCorrect,
        score: isCorrect ? q.score : 0
      });
      
      // 점수 추가
      if (isCorrect) {
        score += q.score;
      }
      
      // 완료된 문제 수 증가 및 진행률 업데이트
      completedQuestions++;
      updateProgressBar();
      
      // 마지막 문제인 경우 게임 종료
      if (q.id === questions[questions.length - 1].id) {
        // 완료 애니메이션 후 결과 화면으로
        triggerCompletionAnimation().then(() => {
          endGame(true);
        });
      } else {
        // 다음 문제 로드
        const nextIndex = questions.findIndex(item => item.id === currentQuestion) + 1;
        if (nextIndex < questions.length) {
          currentQuestion = questions[nextIndex].id;
          loadQuestion(currentQuestion);
        } else {
          endGame(true);
        }
      }
    }
    
    // ==================== 게임 종료 처리 ====================
    function endGame(completed = false) {
      if (gameOver) return;
      
      gameOver = true;
      timerFunctions.stop();
      
      if (completed) {
        displayResults();
      }
      
      // 게임 섹션 숨기고 결과 섹션 표시
      elements.gameSection.style.display = "none";
      elements.resultSection.style.display = "block";
    }
    
    // ==================== 결과 표시 ====================
    function displayResults() {
      // 최종 점수와 시간 표시
      const maxScore = questions.reduce((sum, q) => sum + q.score, 0);
      elements.finalScore.textContent = `최종 점수: ${score}점 / ${maxScore}점`;
      elements.finalTime.textContent = `경과 시간: ${timerFunctions.formatTime(elapsedTime)}`;
      
      // 문제별 정답/오답 요약 그리드
      const summaryContainer = document.getElementById('answersSummary');
      summaryContainer.innerHTML = "";
      
      userAnswers.forEach(answer => {
        const answerItem = document.createElement('div');
        answerItem.className = `answer-item ${answer.isCorrect ? 'correct' : 'incorrect'}`;
        
        const questionNumber = document.createElement('div');
        questionNumber.className = 'question-number';
        questionNumber.textContent = `문제 ${answer.questionId}`;
        
        const answerText = document.createElement('div');
        answerText.className = answer.isCorrect ? 'correct-answer' : 'incorrect-answer';
        answerText.textContent = answer.isCorrect ? 
                                `정답: ${answer.correctAnswer}` : 
                                `오답: ${answer.userAnswer} (정답: ${answer.correctAnswer})`;
        
        answerItem.appendChild(questionNumber);
        answerItem.appendChild(answerText);
        summaryContainer.appendChild(answerItem);
      });
    }
    
    // ==================== 결과 제출 처리 ====================
    function handleSubmit() {
      elements.loadingSpinner.style.display = "flex";
      
      // 제출할 데이터 준비
      const gameData = {
        gameName: gameTitle,
        playerName: player,
        score: score,
        maxScore: questions.reduce((sum, q) => sum + q.score, 0),
        elapsedTime: elapsedTime,
        answers: userAnswers
      };
      
      // 데이터 전송 시뮬레이션 (실제 서버로 전송하려면 이 부분을 수정해야 함)
      setTimeout(() => {
        elements.loadingSpinner.style.display = "none";
        elements.response.textContent = JSON.stringify(gameData, null, 2);
        elements.submitButton.disabled = true;
        alert("결과가 성공적으로 전송되었습니다!");
      }, 1500);
    }
    
    // ==================== 이벤트 리스너 설정 ====================
    function setupEventListeners() {
      // 시작 버튼
      elements.startButton.addEventListener('click', () => {
        player = elements.playerName.value.trim();
        if (!player) {
          alert("이름을 입력해주세요!");
          return;
        }
        
        // 게임 초기화 및 시작
        resetGame();
        elements.startSection.style.display = "none";
        elements.gameSection.style.display = "block";
        loadQuestion(currentQuestion);
        timerFunctions.start();
      });
      
      // 객관식 옵션 선택
      elements.multipleChoice.addEventListener('click', handleOptionClick);
      
      // 주관식 입력
      elements.answerInput.addEventListener('input', handleShortAnswerInput);
      
      // 다음 문제 버튼
      elements.nextButton.addEventListener('click', handleNextButton);
      
      // 결과 제출 버튼
      elements.submitButton.addEventListener('click', handleSubmit);
    }
    
    // ==================== 페이지 로드 시 초기화 ====================
    window.onload = function() {
      // 게임 데이터 초기화
      document.getElementById('pageTitle').textContent = gameTitle;
      elements.gameTitle.textContent = gameTitle;
      
      // 배너 설정 (값이 있는 경우에만 표시)
      if (bannerURL) {
        elements.banner.style.display = "block";
        elements.banner.innerHTML = `<img src="${bannerURL}" alt="배너">`;
      }
      
      // 문제 데이터 초기화
      initQuestions();
      
      // 이벤트 리스너 설정
      setupEventListeners();
    };
  </script>
</body>
</html>